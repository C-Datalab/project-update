name: "Add Issue/PR to Project"
on:
  issues:
    types: [opened]
  pull_request:
    types: [opened]

jobs:
  add_to_project:
    name: Add to Project
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - uses: austenstone/project-add@main
        with:
          user: ${{ github.repository_owner }}
          project-number: 5
          github-token: "${{ secrets.MY_TOKEN }}"
        id: project-add
      - uses: actions/script@v6
        with:
          script: |
            return {
              time: (new Date()).toISOString().replace(/\..*Z/g, '+00:00')
            }
        id: get-current-time
      - uses: ./
        with:
          user: ${{ github.repository_owner }}
          project-number: 5
          github-token: "${{ secrets.MY_TOKEN }}"
          item-id: ${{ steps.project-add.outputs.id }}
          fields: product,priority,last-run
          fields-value: back-end,high,${{ steps.get-current-time.outputs.time }}